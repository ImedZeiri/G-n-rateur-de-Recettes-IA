
@if (recipe()) {
  @let r = recipe();
  <div class="group relative rounded-2xl shadow-lg overflow-hidden h-full flex flex-col justify-end transition-all duration-300 ease-in-out hover:shadow-2xl hover:-translate-y-1 bg-gray-800">
    
    <!-- Clickable Background Image & Overlay -->
    <div (click)="onPlayVideo()" class="absolute inset-0 cursor-pointer">
      <img [src]="r.imageUrl" [alt]="r.recipeName" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
      <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/50 to-transparent"></div>
      <!-- Play Icon on Hover -->
      <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-black/40">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-white" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm-1.25,14.5V7.5l6,3.5-6,3.5Z"/>
        </svg>
      </div>
    </div>

    <!-- Pin Button -->
    <button 
      (click)="onTogglePin()" 
      [attr.aria-label]="r.isPinned ? t('unpinRecipe') : t('pinRecipe')"
      class="absolute top-4 right-4 z-10 p-2 rounded-full transition-all duration-300 hover:scale-110"
      [class.bg-amber-400]="r.isPinned"
      [class.text-white]="r.isPinned"
      [class.hover:bg-amber-500]="r.isPinned"
      [class.bg-black/50]="!r.isPinned"
      [class.text-white]="!r.isPinned"
      [class.hover:bg-black/70]="!r.isPinned">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
        <path d="M16,12V4a1,1,0,0,0-1-1H9A1,1,0,0,0,8,4v8l-2.29,2.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L10,13.41V20a1,1,0,0,0,2,0V13.41l2.88,2.88a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z" />
      </svg>
    </button>
    
    <!-- Content Area at the bottom -->
    <div class="relative z-0 p-4 text-white">
      <h3 class="text-xl sm:text-2xl font-bold font-serif mb-2 drop-shadow-md">{{ r.recipeName }}</h3>
      <p class="text-sm mb-4 drop-shadow-sm text-gray-200">{{ r.description }}</p>

      <!-- Expandable Details with Glassmorphism Effect -->
      <div class="bg-white/10 backdrop-blur-md rounded-xl border border-white/20 overflow-hidden">
        <div class="p-4">
          <h4 class="font-semibold text-md flex items-center gap-x-2 text-white mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M12.22,10.64a1,1,0,0,0,1.41,0,3,3,0,0,1,4.24,0,1,1,0,0,0,1.41-1.41,5,5,0,0,0-7.07,0,1,1,0,0,0,0,1.41Z"/><path d="M11.51,20.49a1,1,0,0,0,1,0,8.49,8.49,0,0,0,6.56-8.2V9a1,1,0,0,0-1-1H5.93a1,1,0,0,0-1,1v3.25A8.49,8.49,0,0,0,11.51,20.49ZM7.93,9h8.14v3.25a7.48,7.48,0,0,1-8.14,7.45A7.48,7.48,0,0,1,7.93,12.25Z"/></svg>
            <span>{{ t('ingredients') }}</span>
          </h4>
          <ul class="list-disc list-inside space-y-1 text-sm pl-2 text-gray-200">
            @for (ingredient of r.ingredients; track $index) {
              <li>{{ ingredient }}</li>
            }
          </ul>
        </div>
        
        @if (isExpanded()) {
          <div class="p-4 border-t border-white/20 animate-fade-in" style="animation-duration: 0.4s;">
            <h4 class="font-semibold text-md flex items-center gap-x-2 text-white mb-2">
               <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M20,9.5a.5.5,0,0,0-.5-.5H14V3.5a.5.5,0,0,0-.5-.5h-3a.5.5,0,0,0-.5.5V9H4.5a.5.5,0,0,0-.5.5v5a.5.5,0,0,0,.5.5H10v5.5a.5.5,0,0,0,.5.5h3a.5.5,0,0,0,.5-.5V15h5.5a.5.5,0,0,0,.5-.5Z"/></svg>
              <span>{{ t('instructions') }}</span>
            </h4>
            <ol class="list-decimal list-inside space-y-2 text-sm pl-2 text-gray-200">
              @for (instruction of r.instructions; track $index) {
                <li>{{ instruction }}</li>
              }
            </ol>
          </div>
        }
        
        @if(r.instructions.length > 2) {
          <div class="bg-black/20 hover:bg-black/40 transition-colors">
             <button (click)="toggleInstructions()" class="w-full text-center p-2 text-sm font-semibold text-white">
              {{ isExpanded() ? t('seeLess') : t('seeMore') }}
            </button>
          </div>
        }
      </div>
    </div>
  </div>
}