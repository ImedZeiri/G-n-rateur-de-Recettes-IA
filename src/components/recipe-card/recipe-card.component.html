
@if (recipe()) {
  @let r = recipe();
  <div class="relative bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden h-full flex flex-col transition-all duration-300 ease-in-out hover:shadow-2xl hover:-translate-y-2">
    
    <button 
      (click)="onTogglePin()" 
      [attr.aria-label]="r.isPinned ? t('unpinRecipe') : t('pinRecipe')"
      class="absolute top-3 right-3 z-10 p-2 rounded-full transition-colors"
      [class.bg-amber-400/80]="r.isPinned"
      [class.text-white]="r.isPinned"
      [class.bg-black/30]="!r.isPinned"
      [class.text-amber-300]="!r.isPinned"
      [class.hover:bg-amber-500/90]="r.isPinned"
      [class.hover:bg-black/50]="!r.isPinned">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor">
        <path d="M16,12V4a1,1,0,0,0-1-1H9A1,1,0,0,0,8,4v8l-2.29,2.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L10,13.41V20a1,1,0,0,0,2,0V13.41l2.88,2.88a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z" />
      </svg>
    </button>
    
    <img [src]="r.imageUrl" [alt]="r.recipeName" class="w-full h-48 object-cover">
    
    <div class="p-6 flex-grow flex flex-col">
      <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">{{ r.recipeName }}</h3>
      <p class="text-gray-600 dark:text-gray-400 text-sm mb-4 flex-grow">{{ r.description }}</p>

      <div class="space-y-4 mb-6">
        <div>
          <h4 class="font-semibold text-md text-indigo-600 dark:text-indigo-400 mb-2 border-b border-gray-200 dark:border-gray-700 pb-1">{{ t('ingredients') }}</h4>
          <ul class="list-disc list-inside space-y-1 text-sm text-gray-700 dark:text-gray-300 pl-2">
            @for (ingredient of r.ingredients; track $index) {
              <li>{{ ingredient }}</li>
            }
          </ul>
        </div>

        <div>
          <h4 class="font-semibold text-md text-indigo-600 dark:text-indigo-400 mb-2 border-b border-gray-200 dark:border-gray-700 pb-1">{{ t('instructions') }}</h4>
          <ol class="list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300 pl-2">
            @for (instruction of (isExpanded() ? r.instructions : r.instructions.slice(0, 3)); track $index) {
              <li>{{ instruction }}</li>
            }
          </ol>
          @if(r.instructions.length > 3) {
            <button (click)="toggleInstructions()" class="text-sm font-semibold text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-300 mt-2">
              {{ isExpanded() ? t('seeLess') : t('seeMore') }}
            </button>
          }
        </div>
      </div>
      
      <div class="mt-auto border-t border-gray-200 dark:border-gray-700 pt-4">
        <button type="button" (click)="onPlayVideo()"
           class="w-full flex items-center justify-center gap-x-2 px-4 py-2 bg-red-600 text-white font-semibold rounded-lg shadow-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:focus:ring-offset-gray-800 transition-colors duration-200">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor">
            <path d="M10,15V9l5,3Z"></path><path d="M20.45,4.32A5.45,5.45,0,0,0,16.6,2.37C14.76,2,12,2,12,2s-2.76,0-4.6.37A5.45,5.45,0,0,0,3.55,4.32,56.6,56.6,0,0,0,2.37,8.23,62,62,0,0,0,2,12s0,3.77.37,5.68A5.45,5.45,0,0,0,3.55,19.68a5.45,5.45,0,0,0,3.85,1.95C9.24,22,12,22,12,22s2.76,0,4.6-.37a5.45,5.45,0,0,0,3.85-1.95A5.45,5.45,0,0,0,21.63,17.77,56.6,56.6,0,0,0,22,12,62,62,0,0,0,21.63,8.23,56.6,56.6,0,0,0,20.45,4.32Z"></path>
          </svg>
          <span>{{ t('youtubeButton') }}</span>
        </button>
      </div>
    </div>
  </div>
}
